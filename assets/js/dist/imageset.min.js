/*!
 * ImageSet (1.0.0-alpha1)
 *
 * This script file is needed for lazyloading imagesets,
 * generated with ImageSet for Kirby.
 *
 * Copyright (c) 2016 Fabian Michael <hallo@fabianmichael.de>
 * 
 * @license SEE LICENSE IN license.md
 */
!function(e,t,a){"use strict";function n(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}function i(e){"loading"!=t.readyState?e():t.addEventListener("DOMContentLoaded",e)}function s(){var t=1;return e.screen.systemXDPI!==a&&e.screen.logicalXDPI!==a&&e.screen.systemXDPI>e.screen.logicalXDPI?t=e.screen.systemXDPI/e.screen.logicalXDPI:e.devicePixelRatio!==a&&(t=e.devicePixelRatio),t}var r={wrapperClass:"imageset",wrapperLazyloadClass:"imageset--lazyload",wrapperLoadedClass:"imageset--loaded",imageElementClass:"imageset__element",placeholderClass:"imageset__placeholder",placeholderLoadedClass:"imageset__placeholder--loaded",placeholderMosaicClass:"imageset--placeholder--mosaic"},o="[object OperaMini]"===Object.prototype.toString.call(e.operamini),l=!!e.CanvasRenderingContext2D,c="imageRendering"in t.documentElement.style||"msInterpolationMode"in t.documentElement.style,d=!!e.MutationObserver,u=e.requestAnimationFrame||function(e){setTimeout(e,1e3/60)},f=function(){return t.documentElement.classList?function(e,t){return e.classList.contains(t)}:function(e,t){return!!~e.className.split(/\s+/).indexOf(t)}}(),m=function(){return t.documentElement.classList?function(e,t){e.classList.add(t)}:function(e,t){var a=e.className.split(/\s+/);~a.indexOf(t)||(a.push(t),e.className=a.join(" "))}}(),g=function(){return t.documentElement.classList?function(e,t){return e.classList.remove(t)}:function(e,t){var a=e.className.split(/\s+/),n=a.indexOf(t);~n&&(a.splice(n,1),e.className=a.join(" "))}}();if(g(t.documentElement,"no-js"),m(t.documentElement,"js"),o){e.lazySizesConfig=e.lazySizesConfig||{},e.lazySizesConfig.init=!1;var v=function(t){var a=t.getElementsByTagName("source"),n=t.getElementsByClassName(r.imageElementClass)[0];if(m(t,r.wrapperLoadedClass),e.HTMLPictureElement){for(var i=0,s=a.length;i<s;i++){var o=a[i];o.hasAttribute("data-srcset")&&(o.srcset=o.getAttribute("data-srcset"),o.removeAttribute("data-srcset")),o.hasAttribute("data-src")&&(o.src=o.getAttribute("data-src"),o.removeAttribute("data-src"))}n.hasAttribute("data-srcset")&&(n.srcset=n.getAttribute("data-srcset"),n.removeAttribute("data-srcset")),n.hasAttribute("data-src")&&(n.src=n.getAttribute("data-src"),n.removeAttribute("data-src"))}else{for(var l=a.length>0?a[a.length-1]:n,c=l.getAttribute("data-srcset").split(/,\s+/),d=a.length;d--;)a[d].parentNode.removeChild(a[d]);n.src=c.pop().replace(/\s+\d+[wx]$/,"")}};i(function(){for(var e=t.getElementsByClassName(r.placeholderMosaicClass),a=0,n=e.length;a<n;a++)v(e[a])})}else{if(e.imageSetConfig&&n(r,e.imageSetConfig),e.imageSetConfig=r,!c&&l){var h=Math.min(2,s()),p=function(e){if(!e.querySelector("canvas."+r.placeholderClass)){var a=t.createElement("canvas"),n=a.getContext("2d"),i=e.getElementsByClassName(r.placeholderClass)[0],s=function(){var e=i.naturalWidth,t=i.naturalHeight,s=100*h,r=Math.round(e*s),o=Math.round(t*s);a.width=r,a.height=o,n.mozImageSmoothingEnabled=!1,n.webkitImageSmoothingEnabled=!1,n.msImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1,a.setAttribute("aria-hidden",!0),a.className=i.className,u(function(){n.drawImage(i,0,0,r,o),i.parentNode.appendChild(a),i.parentNode.removeChild(i)})};i.complete&&"undefined"!=typeof i.naturalWidth&&0!==i.naturalWidth?s():i.addEventListener("load",s)}};i(function(){for(var e=t.getElementsByClassName(r.placeholderMosaicClass),a=0,n=e.length;a<n;a++)p(e[a]);if(d){var i=new MutationObserver(function(e){for(var t=0;t<e.length;t++){var a=e[t];if("childList"===a.type&&a.addedNodes.length){for(var n=0;n<a.addedNodes.length;n++){var i=a.addedNodes[n];i.nodeType===Node.ELEMENT_NODE&&f(i,r.placeholderMosaicClass)&&p(i)}return}}}),s={attributes:!1,childList:!0,characterData:!1,subtree:!0};i.observe(t.documentElement,s)}})}t.addEventListener("lazybeforeunveil",function(e){var t=e.target,a=t.parentNode;if(f(t,r.imageElementClass)){for(;!f(a,r.wrapperClass);)a=a.parentNode;var n=function(){u(function(){m(a,r.wrapperLoadedClass),t.removeEventListener("load",n)})};t.addEventListener("load",n)}})}}(window,document),/*!
 * lazysizes 2.0.7 (with "static-gecko-picture" plugin)
 * 
 * Copyright (C) 2015 Alexander Farkas
 * 
 * @license The MIT License (MIT)
 */
function(e,t){var a=t(e,e.document);e.lazySizes=a,"object"==typeof module&&module.exports&&(module.exports=a)}(window,function(e,t){"use strict";if(t.getElementsByClassName){var a,n=t.documentElement,i=e.Date,s=e.HTMLPictureElement,r="addEventListener",o="getAttribute",l=e[r],c=e.setTimeout,d=e.requestAnimationFrame||c,u=e.requestIdleCallback,f=/^picture$/i,m=["load","error","lazyincluded","_lazyloaded"],g={},v=Array.prototype.forEach,h=function(e,t){return g[t]||(g[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),g[t].test(e[o]("class")||"")&&g[t]},p=function(e,t){h(e,t)||e.setAttribute("class",(e[o]("class")||"").trim()+" "+t)},C=function(e,t){var a;(a=h(e,t))&&e.setAttribute("class",(e[o]("class")||"").replace(a," "))},y=function(e,t,a){var n=a?r:"removeEventListener";a&&y(e,t),m.forEach(function(a){e[n](a,t)})},z=function(e,a,n,i,s){var r=t.createEvent("CustomEvent");return r.initCustomEvent(a,!i,!s,n||{}),e.dispatchEvent(r),r},A=function(t,n){var i;!s&&(i=e.picturefill||a.pf)?i({reevaluate:!0,elements:[t]}):n&&n.src&&(t.src=n.src)},E=function(e,t){return(getComputedStyle(e,null)||{})[t]},b=function(e,t,n){for(n=n||e.offsetWidth;n<a.minSize&&t&&!e._lazysizesWidth;)n=t.offsetWidth,t=t.parentNode;return n},N=function(){var e,a,n=[],i=function(){var t;for(e=!0,a=!1;n.length;)t=n.shift(),t[0].apply(t[1],t[2]);e=!1},s=function(s){e?s.apply(this,arguments):(n.push([s,this,arguments]),a||(a=!0,(t.hidden?c:d)(i)))};return s._lsFlush=i,s}(),L=function(e,t){return t?function(){N(e)}:function(){var t=this,a=arguments;N(function(){e.apply(t,a)})}},w=function(e){var t,a=0,n=125,s=666,r=s,o=function(){t=!1,a=i.now(),e()},l=u?function(){u(o,{timeout:r}),r!==s&&(r=s)}:L(function(){c(o)},!0);return function(e){var s;(e=e===!0)&&(r=44),t||(t=!0,s=n-(i.now()-a),s<0&&(s=0),e||s<9&&u?l():c(l,s))}},M=function(e){var t,a,n=99,s=function(){t=null,e()},r=function(){var e=i.now()-a;e<n?c(r,n-e):(u||s)(s)};return function(){a=i.now(),t||(t=c(r,n))}},S=function(){var s,d,u,m,g,b,S,x,B,O,P,T,D,I,W,R=/^img$/i,k=/^iframe$/i,F="onscroll"in e&&!/glebot/.test(navigator.userAgent),$=0,j=0,H=0,X=-1,q=function(e){H--,e&&e.target&&y(e.target,q),(!e||H<0||!e.target)&&(H=0)},U=function(e,a){var i,s=e,r="hidden"==E(t.body,"visibility")||"hidden"!=E(e,"visibility");for(B-=a,T+=a,O-=a,P+=a;r&&(s=s.offsetParent)&&s!=t.body&&s!=n;)r=(E(s,"opacity")||1)>0,r&&"visible"!=E(s,"overflow")&&(i=s.getBoundingClientRect(),r=P>i.left&&O<i.right&&T>i.top-1&&B<i.bottom+1);return r},G=function(){var e,i,r,l,c,f,m,v,h;if((g=a.loadMode)&&H<8&&(e=s.length)){i=0,X++,null==I&&("expand"in a||(a.expand=n.clientHeight>500&&n.clientWidth>500?500:370),D=a.expand,I=D*a.expFactor),j<I&&H<1&&X>2&&g>2&&!t.hidden?(j=I,X=0):j=g>1&&X>1&&H<6?D:$;for(;i<e;i++)if(s[i]&&!s[i]._lazyRace)if(F)if((v=s[i][o]("data-expand"))&&(f=1*v)||(f=j),h!==f&&(S=innerWidth+f*W,x=innerHeight+f,m=f*-1,h=f),r=s[i].getBoundingClientRect(),(T=r.bottom)>=m&&(B=r.top)<=x&&(P=r.right)>=m*W&&(O=r.left)<=S&&(T||P||O||B)&&(u&&H<3&&!v&&(g<3||X<4)||U(s[i],f))){if(te(s[i]),c=!0,H>9)break}else!c&&u&&!l&&H<4&&X<4&&g>2&&(d[0]||a.preloadAfterLoad)&&(d[0]||!v&&(T||P||O||B||"auto"!=s[i][o](a.sizesAttr)))&&(l=d[0]||s[i]);else te(s[i]);l&&!c&&te(l)}},K=w(G),Q=function(e){p(e.target,a.loadedClass),C(e.target,a.loadingClass),y(e.target,V)},J=L(Q),V=function(e){J({target:e.target})},Y=function(e,t){try{e.contentWindow.location.replace(t)}catch(a){e.src=t}},Z=function(e){var t,n,i=e[o](a.srcsetAttr);(t=a.customMedia[e[o]("data-media")||e[o]("media")])&&e.setAttribute("media",t),i&&e.setAttribute("srcset",i),t&&(n=e.parentNode,n.insertBefore(e.cloneNode(),e),n.removeChild(e))},ee=L(function(e,t,n,i,s){var r,l,d,u,g,h;(g=z(e,"lazybeforeunveil",t)).defaultPrevented||(i&&(n?p(e,a.autosizesClass):e.setAttribute("sizes",i)),l=e[o](a.srcsetAttr),r=e[o](a.srcAttr),s&&(d=e.parentNode,u=d&&f.test(d.nodeName||"")),h=t.firesLoad||"src"in e&&(l||r||u),g={target:e},h&&(y(e,q,!0),clearTimeout(m),m=c(q,2500),p(e,a.loadingClass),y(e,V,!0)),u&&v.call(d.getElementsByTagName("source"),Z),l?e.setAttribute("srcset",l):r&&!u&&(k.test(e.nodeName)?Y(e,r):e.src=r),(l||u)&&A(e,{src:r})),N(function(){e._lazyRace&&delete e._lazyRace,C(e,a.lazyClass),h&&!e.complete||(h?q(g):H--,Q(g))})}),te=function(e){var t,n=R.test(e.nodeName),i=n&&(e[o](a.sizesAttr)||e[o]("sizes")),s="auto"==i;(!s&&u||!n||!e.src&&!e.srcset||e.complete||h(e,a.errorClass))&&(t=z(e,"lazyunveilread").detail,s&&_.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,H++,ee(e,t,s,i,n))},ae=function(){if(!u){if(i.now()-b<999)return void c(ae,999);var e=M(function(){a.loadMode=3,K()});u=!0,a.loadMode=3,K(),l("scroll",function(){3==a.loadMode&&(a.loadMode=2),e()},!0)}};return{_:function(){b=i.now(),s=t.getElementsByClassName(a.lazyClass),d=t.getElementsByClassName(a.lazyClass+" "+a.preloadClass),W=a.hFac,l("scroll",K,!0),l("resize",K,!0),e.MutationObserver?new MutationObserver(K).observe(n,{childList:!0,subtree:!0,attributes:!0}):(n[r]("DOMNodeInserted",K,!0),n[r]("DOMAttrModified",K,!0),setInterval(K,999)),l("hashchange",K,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){t[r](e,K,!0)}),/d$|^c/.test(t.readyState)?ae():(l("load",ae),t[r]("DOMContentLoaded",K),c(ae,2e4)),s.length?G():K()},checkElems:K,unveil:te}}(),_=function(){var e,n=L(function(e,t,a,n){var i,s,r;if(e._lazysizesWidth=n,n+="px",e.setAttribute("sizes",n),f.test(t.nodeName||""))for(i=t.getElementsByTagName("source"),s=0,r=i.length;s<r;s++)i[s].setAttribute("sizes",n);a.detail.dataAttr||A(e,a.detail)}),i=function(e,t,a){var i,s=e.parentNode;s&&(a=b(e,s,a),i=z(e,"lazybeforesizes",{width:a,dataAttr:!!t}),i.defaultPrevented||(a=i.detail.width,a&&a!==e._lazysizesWidth&&n(e,s,i,a)))},s=function(){var t,a=e.length;if(a)for(t=0;t<a;t++)i(e[t])},r=M(s);return{_:function(){e=t.getElementsByClassName(a.autosizesClass),l("resize",r)},checkElems:r,updateElem:i}}(),x=function(){x.i||(x.i=!0,_._(),S._())};return function(){var t,n={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2};a=e.lazySizesConfig||e.lazysizesConfig||{};for(t in n)t in a||(a[t]=n[t]);e.lazySizesConfig=a,c(function(){a.init&&x()})}(),{cfg:a,autoSizer:_,loader:S,init:x,uP:A,aC:p,rC:C,hC:h,fire:z,gW:b,rAF:N}}}),function(e){var t=navigator.userAgent;e.HTMLPictureElement&&/ecko/.test(t)&&t.match(/rv\:(\d+)/)&&RegExp.$1<41&&addEventListener("resize",function(){var t,a=document.createElement("source"),n=function(e){var t,n,i=e.parentNode;"PICTURE"===i.nodeName.toUpperCase()?(t=a.cloneNode(),i.insertBefore(t,i.firstElementChild),setTimeout(function(){i.removeChild(t)})):(!e._pfLastSize||e.offsetWidth>e._pfLastSize)&&(e._pfLastSize=e.offsetWidth,n=e.sizes,e.sizes+=",100vw",setTimeout(function(){e.sizes=n}))},i=function(){var e,t=document.querySelectorAll("picture > img, img[srcset][sizes]");for(e=0;e<t.length;e++)n(t[e])},s=function(){clearTimeout(t),t=setTimeout(i,99)},r=e.matchMedia&&matchMedia("(orientation: landscape)"),o=function(){s(),r&&r.addListener&&r.addListener(s)};return a.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?o():document.addEventListener("DOMContentLoaded",o),s}())}(window);