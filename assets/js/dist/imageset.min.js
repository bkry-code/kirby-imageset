/*!
 * ImageSet (1.0.0-beta1)
 *
 * This script file is needed for lazyloading imagesets,
 * generated with ImageSet for Kirby and rendering placeholder
 * effeccts
 *
 * Copyright (c) 2016 Fabian Michael <hallo@fabianmichael.de>
 * @license SEE LICENSE IN license.md
 *
 * This script also includes:
 *
 *   StackBlur 0.6
 *   Copyright (c) 2010 Mario Klingemann <mario@quasimondo.com>
 *   https://github.com/Quasimondo/QuasimondoJS
 *
 *   lazysizes 2.0.7 (with "static-gecko-picture" plugin)
 *   Copyright (C) 2015 Alexander Farkas, released under MIT license
 *   https://github.com/aFarkas/lazysizes
 * 
 */
!function(e,t,n){"use strict";function a(e,t,n,a,r,o,s,l){var c=e.getContext("2d"),d=c.getImageData(t,n,a,r);d=i(d,o,s,l),c.putImageData(d,t,n)}function i(e,t,n,a){var i,r,s,l,c,d,u,f,m,g,v,h,p,z,y,b,A,C,E,x,w,M,N,S,L,I=e.data,B=e.width,D=e.height,_=t+t+1,W=B-1,O=D-1,R=t+1,T=R*(R+1)/2,P=new o,k=P;for(s=1;s<_;s++)k=k.next=new o,s==R&&(L=k);k.next=P;var F=null,H=null;for(u=d=0,r=0;r<D;r++){for(b=A=C=E=f=m=g=v=0,h=R*(x=I[d]),p=R*(w=I[d+1]),z=R*(M=I[d+2]),y=R*(N=I[d+3]),f+=T*x,m+=T*w,g+=T*M,v+=T*N,k=P,s=0;s<R;s++)k.r=x,k.g=w,k.b=M,k.a=N,k=k.next;for(s=1;s<R;s++)l=d+((W<s?W:s)<<2),f+=(k.r=x=I[l])*(S=R-s),m+=(k.g=w=I[l+1])*S,g+=(k.b=M=I[l+2])*S,v+=(k.a=N=I[l+3])*S,b+=x,A+=w,C+=M,E+=N,k=k.next;for(F=P,H=L,i=0;i<B;i++)I[d]=f*n>>a,I[d+1]=m*n>>a,I[d+2]=g*n>>a,I[d+3]=v*n>>a,f-=h,m-=p,g-=z,v-=y,h-=F.r,p-=F.g,z-=F.b,y-=F.a,l=u+((l=i+t+1)<W?l:W)<<2,b+=F.r=I[l],A+=F.g=I[l+1],C+=F.b=I[l+2],E+=F.a=I[l+3],f+=b,m+=A,g+=C,v+=E,F=F.next,h+=x=H.r,p+=w=H.g,z+=M=H.b,y+=N=H.a,b-=x,A-=w,C-=M,E-=N,H=H.next,d+=4;u+=B}for(i=0;i<B;i++){for(A=C=E=b=m=g=v=f=0,d=i<<2,h=R*(x=I[d]),p=R*(w=I[d+1]),z=R*(M=I[d+2]),y=R*(N=I[d+3]),f+=T*x,m+=T*w,g+=T*M,v+=T*N,k=P,s=0;s<R;s++)k.r=x,k.g=w,k.b=M,k.a=N,k=k.next;for(c=B,s=1;s<=t;s++)d=c+i<<2,f+=(k.r=x=I[d])*(S=R-s),m+=(k.g=w=I[d+1])*S,g+=(k.b=M=I[d+2])*S,v+=(k.a=N=I[d+3])*S,b+=x,A+=w,C+=M,E+=N,k=k.next,s<O&&(c+=B);for(d=i,F=P,H=L,r=0;r<D;r++)l=d<<2,I[l+3]=N=v*n>>a,N>0?(N=255/N,I[l]=(f*n>>a)*N,I[l+1]=(m*n>>a)*N,I[l+2]=(g*n>>a)*N):I[l]=I[l+1]=I[l+2]=0,f-=h,m-=p,g-=z,v-=y,h-=F.r,p-=F.g,z-=F.b,y-=F.a,l=i+((l=r+R)<O?l:O)*B<<2,f+=b+=F.r=I[l],m+=A+=F.g=I[l+1],g+=C+=F.b=I[l+2],v+=E+=F.a=I[l+3],F=F.next,h+=x=H.r,p+=w=H.g,z+=M=H.b,y+=N=H.a,b-=x,A-=w,C-=M,E-=N,H=H.next,d+=B}return e}function r(e,t,n,a,i,r,s,l){var c,d,u,f,m,g,v,h,p,z,y,b,A,C,E,x,w,M,N,S,L,I=e.getContext("2d"),B=I.getImageData(t,n,a,i),D=B.data,_=r+r+1,W=a-1,O=i-1,R=r+1,T=R*(R+1)/2,P=new o,k=P;for(u=1;u<_;u++)k=k.next=new o,u==R&&(L=k);k.next=P;var F=null,H=null;for(v=g=0,d=0;d<i;d++){for(C=E=x=h=p=z=0,y=R*(w=D[g]),b=R*(M=D[g+1]),A=R*(N=D[g+2]),h+=T*w,p+=T*M,z+=T*N,k=P,u=0;u<R;u++)k.r=w,k.g=M,k.b=N,k=k.next;for(u=1;u<R;u++)f=g+((W<u?W:u)<<2),h+=(k.r=w=D[f])*(S=R-u),p+=(k.g=M=D[f+1])*S,z+=(k.b=N=D[f+2])*S,C+=w,E+=M,x+=N,k=k.next;for(F=P,H=L,c=0;c<a;c++)D[g]=h*s>>l,D[g+1]=p*s>>l,D[g+2]=z*s>>l,h-=y,p-=b,z-=A,y-=F.r,b-=F.g,A-=F.b,f=v+((f=c+r+1)<W?f:W)<<2,C+=F.r=D[f],E+=F.g=D[f+1],x+=F.b=D[f+2],h+=C,p+=E,z+=x,F=F.next,y+=w=H.r,b+=M=H.g,A+=N=H.b,C-=w,E-=M,x-=N,H=H.next,g+=4;v+=a}for(c=0;c<a;c++){for(E=x=C=p=z=h=0,g=c<<2,y=R*(w=D[g]),b=R*(M=D[g+1]),A=R*(N=D[g+2]),h+=T*w,p+=T*M,z+=T*N,k=P,u=0;u<R;u++)k.r=w,k.g=M,k.b=N,k=k.next;for(m=a,u=1;u<=r;u++)g=m+c<<2,h+=(k.r=w=D[g])*(S=R-u),p+=(k.g=M=D[g+1])*S,z+=(k.b=N=D[g+2])*S,C+=w,E+=M,x+=N,k=k.next,u<O&&(m+=a);for(g=c,F=P,H=L,d=0;d<i;d++)f=g<<2,D[f]=h*s>>l,D[f+1]=p*s>>l,D[f+2]=z*s>>l,h-=y,p-=b,z-=A,y-=F.r,b-=F.g,A-=F.b,f=c+((f=d+R)<O?f:O)*a<<2,h+=C+=F.r=D[f],p+=E+=F.g=D[f+1],z+=x+=F.b=D[f+2],F=F.next,y+=w=H.r,b+=M=H.g,A+=N=H.b,C-=w,E-=M,x-=N,H=H.next,g+=a}I.putImageData(B,t,n)}function o(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}e.stackBlur={canvasRGB:r,canvasRGBA:a}}(window,document),function(e,t){"use strict";function n(e,t){var n=null;return function(){var a=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(a,i)},t)}}function a(e){var t=e[C].match(P);return!!t&&t[1]}var i="getElementsByClassName";if(t[i]){var r="imageset",o=r,s=r+"--loaded",l=r+"--placeholder",c=r+"--placeholder--",d=r+"--alpha",u=r+"--placeholder--rendered",f=r+"__element",m=r+"__placeholder",g=r+"-js",v=t.documentElement,h=navigator.userAgent,p=(e.requestAnimationFrame||setTimeout,e.Date,"addEventListener"),z="getAttribute",y="removeAttribute",b="MutationObserver",A="classList",C="className",E="hasAttribute",x="data-src",w="data-srcset",M="[object OperaMini]"===Object.prototype.toString.call(e.operamini),N=h.indexOf("Safari")!==-1&&h.indexOf("Chrome")===-1,S=!!e[b],L=!!e.CanvasRenderingContext2D,I="imageRendering"in v.style||"msInterpolationMode"in v.style,B=e.requestAnimationFrame||function(e){setTimeout(e,1e3/60)},D=function(e){"loading"!=t.readyState?e():t[p]("DOMContentLoaded",e)},_=function(e,t){e.complete&&"undefined"!=typeof e.naturalWidth&&0!==e.naturalWidth?t():e[p]("load",t)},W=function(){function e(e){a.push(e),n()}function t(){var e=a.shift();e(),a.length?B(t):i=!1}function n(){i||(i=!0,B(t))}var a=[],i=!1;return{add:e}}(),O=function(){return t.documentElement[A]?function(e,t){return e[A].contains(t)}:function(e,t){return!!~e[C].split(/\s+/).indexOf(t)}}(),R=function(){return t.documentElement[A]?function(e,t){e[A].add(t)}:function(e,t){var n=e[C].split(/\s+/);~n.indexOf(t)||(n.push(t),e[C]=n.join(" "))}}();(function(){return t.documentElement[A]?function(e,t){return e[A].remove(t)}:function(e,t){var n=e[C].split(/\s+/),a=n.indexOf(t);~a&&(n.splice(a,1),e[C]=n.join(" "))}})();if(R(t.documentElement,g),M){e.lazySizesConfig=e.lazySizesConfig||{},e.lazySizesConfig.init=!1;var T=function(t){var n=t.getElementsByTagName("source"),a=t[i](f)[0];if(R(t,s),e.HTMLPictureElement){for(var r=0,o=n.length;r<o;r++){var l=n[r];l[E](w)&&(l.srcset=l[z](w),l[y](w)),l[E](x)&&(l.src=l[z](x),l[y](x))}a[E](w)&&(a.srcset=a[z](w),a[y](w)),a[E](x)&&(a.src=a[z](x),a[y](x))}else{for(var c=n.length>0?n[n.length-1]:a,d=c[z](w).split(/,\s+/),u=n.length;u--;)n[u].parentNode.removeChild(n[u]);a.src=d.pop().replace(/\s+\d+[wx]$/,"")}};return void D(function(){for(var e=t[i](o),n=0,a=e.length;n<a;n++)T(e[n])})}var P=new RegExp(c+"([a-z0-9_-]+)\\s*","i"),k={};if(!I||N){var F=function(){return void 0!==e.screen.systemXDPI&&void 0!==e.screen.logicalXDPI&&e.screen.systemXDPI>e.screen.logicalXDPI?e.screen.systemXDPI/e.screen.logicalXDPI:void 0!==e.devicePixelRatio?e.devicePixelRatio:1}();k.mosaic=function(e){var n=t.createElement("canvas"),a=n.getContext("2d"),r=e[i](m)[0],o=function(){var t=r.naturalWidth,i=r.naturalHeight,o=Math.round(e.offsetWidth*F),s=Math.round(e.offsetWidth/t*i*F);n.width=o,n.height=s,a.mozImageSmoothingEnabled=!1,a.webkitImageSmoothingEnabled=!1,a.msImageSmoothingEnabled=!1,a.imageSmoothingEnabled=!1,n.setAttribute("aria-hidden",!0),n[C]=r[C],W.add(function(){a.drawImage(r,0,0,o,s),r.parentNode.replaceChild(n,r)})};_(r,o)}}if(L){var H=function(e,n,a,r){var o=e[i](m)[0],s=function(){var i=o.naturalWidth,s=o.naturalHeight,l=e.offsetWidth,c=Math.round(e.offsetWidth/i*s),u=t.createElement("canvas"),f=u.getContext("2d"),m=O(e,d);u.width=l,u.height=c,u.setAttribute("aria-hidden",!0),u[C]=o[C],W.add(function(){f.drawImage(o,0,0,l,c),stackBlur[m?"canvasRGBA":"canvasRGB"](u,0,0,l,c,n,a,r),o.parentNode.replaceChild(u,o)})};_(o,function(){s()})};k.blurred=function(e){H(e,15,512,17)},k.lqip=function(e){H(e,7,512,15)}}var $=function(){function r(){for(var e,t,n=0,i=d.length;n<i;n++)d[n]&&(t=d[n],O(t,u)||(e=a(t),e&&k[e]&&(R(t,u),k[e](t))))}function c(){t[p]("lazybeforeunveil",function(e){var t=e.target,n=t.parentNode;if(O(t,f)){for(;!O(n,o);)n=n.parentNode;var a=function(){t.removeEventListener("load",a),B(function(){R(n,s)})};t[p]("load",a)}}),d=t[i](l),S?new e[b](m).observe(v,{childList:!0,subtree:!0,attributes:!1,characterData:!1}):(v[p]("DOMNodeInserted",m,!0),v[p]("DOMAttrModified",m,!0),setInterval(m,999)),e[p]("hashchange",m,!0),m()}var d,m=n(r);return{init:c}}();D($.init)}}(window,document),function(e,t){var n=t(e,e.document);e.lazySizes=n,"object"==typeof module&&module.exports&&(module.exports=n)}(window,function(e,t){"use strict";if(t.getElementsByClassName){var n,a=t.documentElement,i=e.Date,r=e.HTMLPictureElement,o="addEventListener",s="getAttribute",l=e[o],c=e.setTimeout,d=e.requestAnimationFrame||c,u=e.requestIdleCallback,f=/^picture$/i,m=["load","error","lazyincluded","_lazyloaded"],g={},v=Array.prototype.forEach,h=function(e,t){return g[t]||(g[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),g[t].test(e[s]("class")||"")&&g[t]},p=function(e,t){h(e,t)||e.setAttribute("class",(e[s]("class")||"").trim()+" "+t)},z=function(e,t){var n;(n=h(e,t))&&e.setAttribute("class",(e[s]("class")||"").replace(n," "))},y=function(e,t,n){var a=n?o:"removeEventListener";n&&y(e,t),m.forEach(function(n){e[a](n,t)})},b=function(e,n,a,i,r){var o=t.createEvent("CustomEvent");return o.initCustomEvent(n,!i,!r,a||{}),e.dispatchEvent(o),o},A=function(t,a){var i;!r&&(i=e.picturefill||n.pf)?i({reevaluate:!0,elements:[t]}):a&&a.src&&(t.src=a.src)},C=function(e,t){return(getComputedStyle(e,null)||{})[t]},E=function(e,t,a){for(a=a||e.offsetWidth;a<n.minSize&&t&&!e._lazysizesWidth;)a=t.offsetWidth,t=t.parentNode;return a},x=function(){var e,n,a=[],i=function(){var t;for(e=!0,n=!1;a.length;)t=a.shift(),t[0].apply(t[1],t[2]);e=!1},r=function(r){e?r.apply(this,arguments):(a.push([r,this,arguments]),n||(n=!0,(t.hidden?c:d)(i)))};return r._lsFlush=i,r}(),w=function(e,t){return t?function(){x(e)}:function(){var t=this,n=arguments;x(function(){e.apply(t,n)})}},M=function(e){var t,n=0,a=125,r=666,o=r,s=function(){t=!1,n=i.now(),e()},l=u?function(){u(s,{timeout:o}),o!==r&&(o=r)}:w(function(){c(s)},!0);return function(e){var r;(e=e===!0)&&(o=44),t||(t=!0,r=a-(i.now()-n),r<0&&(r=0),e||r<9&&u?l():c(l,r))}},N=function(e){var t,n,a=99,r=function(){t=null,e()},o=function(){var e=i.now()-n;e<a?c(o,a-e):(u||r)(r)};return function(){n=i.now(),t||(t=c(o,a))}},S=function(){var r,d,u,m,g,E,S,I,B,D,_,W,O,R,T,P=/^img$/i,k=/^iframe$/i,F="onscroll"in e&&!/glebot/.test(navigator.userAgent),H=0,$=0,j=0,q=-1,X=function(e){j--,e&&e.target&&y(e.target,X),(!e||j<0||!e.target)&&(j=0)},G=function(e,n){var i,r=e,o="hidden"==C(t.body,"visibility")||"hidden"!=C(e,"visibility");for(B-=n,W+=n,D-=n,_+=n;o&&(r=r.offsetParent)&&r!=t.body&&r!=a;)o=(C(r,"opacity")||1)>0,o&&"visible"!=C(r,"overflow")&&(i=r.getBoundingClientRect(),o=_>i.left&&D<i.right&&W>i.top-1&&B<i.bottom+1);return o},U=function(){var e,i,o,l,c,f,m,v,h;if((g=n.loadMode)&&j<8&&(e=r.length)){i=0,q++,null==R&&("expand"in n||(n.expand=a.clientHeight>500&&a.clientWidth>500?500:370),O=n.expand,R=O*n.expFactor),$<R&&j<1&&q>2&&g>2&&!t.hidden?($=R,q=0):$=g>1&&q>1&&j<6?O:H;for(;i<e;i++)if(r[i]&&!r[i]._lazyRace)if(F)if((v=r[i][s]("data-expand"))&&(f=1*v)||(f=$),h!==f&&(S=innerWidth+f*T,I=innerHeight+f,m=f*-1,h=f),o=r[i].getBoundingClientRect(),(W=o.bottom)>=m&&(B=o.top)<=I&&(_=o.right)>=m*T&&(D=o.left)<=S&&(W||_||D||B)&&(u&&j<3&&!v&&(g<3||q<4)||G(r[i],f))){if(te(r[i]),c=!0,j>9)break}else!c&&u&&!l&&j<4&&q<4&&g>2&&(d[0]||n.preloadAfterLoad)&&(d[0]||!v&&(W||_||D||B||"auto"!=r[i][s](n.sizesAttr)))&&(l=d[0]||r[i]);else te(r[i]);l&&!c&&te(l)}},K=M(U),Q=function(e){p(e.target,n.loadedClass),z(e.target,n.loadingClass),y(e.target,V)},J=w(Q),V=function(e){J({target:e.target})},Y=function(e,t){try{e.contentWindow.location.replace(t)}catch(n){e.src=t}},Z=function(e){var t,a,i=e[s](n.srcsetAttr);(t=n.customMedia[e[s]("data-media")||e[s]("media")])&&e.setAttribute("media",t),i&&e.setAttribute("srcset",i),t&&(a=e.parentNode,a.insertBefore(e.cloneNode(),e),a.removeChild(e))},ee=w(function(e,t,a,i,r){var o,l,d,u,g,h;(g=b(e,"lazybeforeunveil",t)).defaultPrevented||(i&&(a?p(e,n.autosizesClass):e.setAttribute("sizes",i)),l=e[s](n.srcsetAttr),o=e[s](n.srcAttr),r&&(d=e.parentNode,u=d&&f.test(d.nodeName||"")),h=t.firesLoad||"src"in e&&(l||o||u),g={target:e},h&&(y(e,X,!0),clearTimeout(m),m=c(X,2500),p(e,n.loadingClass),y(e,V,!0)),u&&v.call(d.getElementsByTagName("source"),Z),l?e.setAttribute("srcset",l):o&&!u&&(k.test(e.nodeName)?Y(e,o):e.src=o),(l||u)&&A(e,{src:o})),x(function(){e._lazyRace&&delete e._lazyRace,z(e,n.lazyClass),h&&!e.complete||(h?X(g):j--,Q(g))})}),te=function(e){var t,a=P.test(e.nodeName),i=a&&(e[s](n.sizesAttr)||e[s]("sizes")),r="auto"==i;(!r&&u||!a||!e.src&&!e.srcset||e.complete||h(e,n.errorClass))&&(t=b(e,"lazyunveilread").detail,r&&L.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,j++,ee(e,t,r,i,a))},ne=function(){if(!u){if(i.now()-E<999)return void c(ne,999);var e=N(function(){n.loadMode=3,K()});u=!0,n.loadMode=3,K(),l("scroll",function(){3==n.loadMode&&(n.loadMode=2),e()},!0)}};return{_:function(){E=i.now(),r=t.getElementsByClassName(n.lazyClass),d=t.getElementsByClassName(n.lazyClass+" "+n.preloadClass),T=n.hFac,l("scroll",K,!0),l("resize",K,!0),e.MutationObserver?new MutationObserver(K).observe(a,{childList:!0,subtree:!0,attributes:!0}):(a[o]("DOMNodeInserted",K,!0),a[o]("DOMAttrModified",K,!0),setInterval(K,999)),l("hashchange",K,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(e){t[o](e,K,!0)}),/d$|^c/.test(t.readyState)?ne():(l("load",ne),t[o]("DOMContentLoaded",K),c(ne,2e4)),r.length?U():K()},checkElems:K,unveil:te}}(),L=function(){var e,a=w(function(e,t,n,a){var i,r,o;if(e._lazysizesWidth=a,a+="px",e.setAttribute("sizes",a),f.test(t.nodeName||""))for(i=t.getElementsByTagName("source"),r=0,o=i.length;r<o;r++)i[r].setAttribute("sizes",a);n.detail.dataAttr||A(e,n.detail)}),i=function(e,t,n){var i,r=e.parentNode;r&&(n=E(e,r,n),i=b(e,"lazybeforesizes",{width:n,dataAttr:!!t}),i.defaultPrevented||(n=i.detail.width,n&&n!==e._lazysizesWidth&&a(e,r,i,n)))},r=function(){var t,n=e.length;if(n)for(t=0;t<n;t++)i(e[t])},o=N(r);return{_:function(){e=t.getElementsByClassName(n.autosizesClass),l("resize",o)},checkElems:o,updateElem:i}}(),I=function(){I.i||(I.i=!0,L._(),S._())};return function(){var t,a={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2};n=e.lazySizesConfig||e.lazysizesConfig||{};for(t in a)t in n||(n[t]=a[t]);e.lazySizesConfig=n,c(function(){n.init&&I()})}(),{cfg:n,autoSizer:L,loader:S,init:I,uP:A,aC:p,rC:z,hC:h,fire:b,gW:E,rAF:x}}}),function(e){var t=navigator.userAgent;e.HTMLPictureElement&&/ecko/.test(t)&&t.match(/rv\:(\d+)/)&&RegExp.$1<41&&addEventListener("resize",function(){var t,n=document.createElement("source"),a=function(e){var t,a,i=e.parentNode;"PICTURE"===i.nodeName.toUpperCase()?(t=n.cloneNode(),i.insertBefore(t,i.firstElementChild),setTimeout(function(){i.removeChild(t)})):(!e._pfLastSize||e.offsetWidth>e._pfLastSize)&&(e._pfLastSize=e.offsetWidth,a=e.sizes,e.sizes+=",100vw",setTimeout(function(){e.sizes=a}))},i=function(){var e,t=document.querySelectorAll("picture > img, img[srcset][sizes]");for(e=0;e<t.length;e++)a(t[e])},r=function(){clearTimeout(t),t=setTimeout(i,99)},o=e.matchMedia&&matchMedia("(orientation: landscape)"),s=function(){r(),o&&o.addListener&&o.addListener(r)};return n.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?s():document.addEventListener("DOMContentLoaded",s),r}())}(window),function(e){"use strict";var t,n,a,i;e.addEventListener&&(t=e.lazySizes&&lazySizes.cfg||e.lazySizesConfig||{},n=t.lazyClass||"lazyload",a=function(){var t,a;if("string"==typeof n&&(n=document.getElementsByClassName(n)),e.lazySizes)for(t=0,a=n.length;t<a;t++)lazySizes.loader.unveil(n[t])},addEventListener("beforeprint",a,!1),!("onbeforeprint"in e)&&e.matchMedia&&(i=matchMedia("print"))&&i.addListener&&i.addListener(function(){i.matches&&a()}))}(window);